(require racket/vector)
(include "trabajo")
(include "competicionAlgoritmos")
(include "algoritmosInversos")
(require (lib "graphics.ss" "graphics"))


;;BURBUJA

(define (rellenarVector button event)
  
  (define menu (new frame% [label "Rellenar vector"]))
  (define tamanyoVector (new text-field% [parent menu] [style (list 'single 'vertical-label)]
                             [label "Numero de elementos"] [init-value (number->string 1)]))

  (define (clickenbotonOK button event) 
    (define nuevoTamanyoVector (string->number (send tamanyoVector get-value)))
    (define aux 0)

    (define (auxRellenar nuevoTamanyoVector)
      (do
          (
           (i 0 (+ i 1))
           (vector2 (vector) (vector-append vector2 (vector aux)) )
           )
        
        ( (= i nuevoTamanyoVector) vector2  )
        (mensaje "Introduzca la componente del vector")
        (set! aux (read))
        )
      )

    (define v (auxRellenar nuevoTamanyoVector))
    (burbuja v)
      
    (send menu show #f)
    (programa)
    )
  
  (define botonOK (new button% [parent menu] [label "OK"][callback clickenbotonOK] ))
  (send menu show #t)
 
  )






(define (rellenarVectorAleatorios button event)
  
  (define menu (new frame% [label "Rellenar vector"]))
  (define tamanyoVector (new text-field% [parent menu] [style (list 'single 'vertical-label)]
                             [label "Numero de elementos"] [init-value (number->string 1)]))

  (define (clickenbotonOK button event)
    (define nuevoTamanyoVector (string->number (send tamanyoVector get-value)))
    ;(define vector (make-vector nuevoTamanyoVector))
    (define (aux nuevoTamanyoVector)
      (do
          (
           (i 0 (+ i 1))
           (vector2 (vector) (vector-append vector2 (vector (inexact->exact (round (* 10 (random)))))))
           )
        ( (= i nuevoTamanyoVector) vector2)
        )
      )
    (burbuja (aux nuevoTamanyoVector))
    (send menu show #f)
    (programa)
    )
  
                  
      
  (define botonOK (new button% [parent menu] [label "OK"] [callback clickenbotonOK]))
  (send menu show #t)
  
  )


(define (cargarFichero button event)
  (mensaje "Introduzca el nombre del fichero (use comillas)")
  (define fichero (read))
  (if (not (file-exists? fichero))
      (mensaje "Fallo en la carga del vector")
      )
  (define puerto (open-input-file fichero))
  (define vector (read puerto))
  (if (vector? vector)
      (burbuja vector)
      (mensaje "Fallo en la carga del vector")
      )
  (programa)
  )


(define (AuxBurbujaAscendente button event)
  (define (volverMenu button event)
    (close-graphics)
    (send menu2 show #f)
    (programa)
    )
  (define menu2 (new frame% [label "Burbuja ascendente"]))
  (define boton1 (new button% [parent menu2] [label "Rellenar vector"] [callback rellenarVector]))
  (define boton2 (new button% [parent menu2] [label "Rellenar vector con valores aleatorios"] [callback rellenarVectorAleatorios]))
  (define boton3 (new button% [parent menu2] [label "Cargar desde fichero"] [callback cargarFichero]))
  (define boton4 (new button% [parent menu2] [label "Volver al menu"] [callback volverMenu]))
  (send menu2 show #t)
  )



;;MERGE SORT
(define (rellenarVectorAleatoriosMG button event)
  
  (define menu (new frame% [label "Rellenar vector"]))
  (define tamanyoVector (new text-field% [parent menu] [style (list 'single 'vertical-label)]
                             [label "Numero de elementos"] [init-value (number->string 1)]))

  (define (clickenbotonOK button event)
    (define nuevoTamanyoVector (string->number (send tamanyoVector get-value)))
    
    (define (aux nuevoTamanyoVector)
      (do
          (
           (i 0 (+ i 1))
           (vector2 (vector) (vector-append vector2 (vector (inexact->exact (round (* 10 (random)))))))
           )
        ( (= i nuevoTamanyoVector) vector2)
        )
      )
    (define v (aux nuevoTamanyoVector))
    (mensaje "El vector a ordenar por Merge Sort es:")
    (mostrarVector v)
    (mergeSort (vector->list v))
    (send menu show #f)
    (programa)
    )
  
                  
      
  (define botonOK (new button% [parent menu] [label "OK"] [callback clickenbotonOK]))
  (send menu show #t)
  
  )


(define (cargarFicheroMG button event)
  (mensaje "Introduzca el nombre del fichero (use comillas)")
  (define fichero (read))
  (if (not (file-exists? fichero))
      (mensaje "Fallo en la carga del vector")
      )      
  (define puerto (open-input-file fichero))
  (define vector (read puerto))
  (if (vector? vector)
      (mergeSort (vector->list vector))
      (mensaje "Fallo en la carga del vector")
      )
  (programa)
  )





(define (rellenarVectorMG button event)
  
  (define menu (new frame% [label "Rellenar vector"]))
  (define tamanyoVector (new text-field% [parent menu] [style (list 'single 'vertical-label)]
                             [label "Numero de elementos"] [init-value (number->string 1)]))

  (define (clickenbotonOK button event) 
    (define nuevoTamanyoVector (string->number (send tamanyoVector get-value)))
    (define aux 0)

    (define (auxRellenarMG nuevoTamanyoVector)
      (do
          (
           (i 0 (+ i 1))
           (vector2 (vector) (vector-append vector2 (vector aux)) )
           )
        
        ( (= i nuevoTamanyoVector) vector2  )
        (mensaje "Introduzca la componente del vector")
        (set! aux (read))
        )
      )

    (define v (auxRellenarMG nuevoTamanyoVector))
    (mensaje "El vector a ordenar por Merge Sort es:")
    (mostrarVector v)
    (mergeSort (vector->list v))
      
    (send menu show #f)
    (programa)
    )
  
  (define botonOK (new button% [parent menu] [label "OK"][callback clickenbotonOK] ))
  (send menu show #t)
 
  )


(define (AuxMergeSortAscendente button event)
  (define (volverMenu button event)
    (close-graphics)
    (send menu2 show #f)
    (programa)
    )
  (define menu2 (new frame% [label "Merge Sort ascendente"]))
  (define boton1 (new button% [parent menu2] [label "Rellenar vector"] [callback rellenarVectorMG]))
  (define boton2 (new button% [parent menu2] [label "Rellenar vector con valores aleatorios"] [callback rellenarVectorAleatoriosMG]))
  (define boton3 (new button% [parent menu2] [label "Cargar desde fichero"] [callback cargarFicheroMG]))
  (define boton4 (new button% [parent menu2] [label "Volver al menu"] [callback volverMenu]))
  (send menu2 show #t)
  )



;;QUICK SORT
(define (rellenarVectorQS button event)
  
  (define menu (new frame% [label "Rellenar vector"]))
  (define tamanyoVector (new text-field% [parent menu] [style (list 'single 'vertical-label)]
                             [label "Numero de elementos"] [init-value (number->string 1)]))

  (define (clickenbotonOK button event) 
    (define nuevoTamanyoVector (string->number (send tamanyoVector get-value)))
    (define aux 0)

    (define (auxRellenarQS nuevoTamanyoVector)
      (do
          (
           (i 0 (+ i 1))
           (vector2 (vector) (vector-append vector2 (vector aux)) )
           )
        
        ( (= i nuevoTamanyoVector) vector2  )
        (mensaje "Introduzca la componente del vector")
        (set! aux (read))
        )
      )

    (define v (auxRellenarQS nuevoTamanyoVector))
    (mensaje "El vector a ordenar por Quick Sort es:")
    (mostrarVector v)
    (QuickSort v)
      
    (send menu show #f)
    (programa)
    )
  
  (define botonOK (new button% [parent menu] [label "OK"][callback clickenbotonOK] ))
  (send menu show #t)
 
  )


(define (rellenarVectorAleatoriosQS button event)
  
  (define menu (new frame% [label "Rellenar vector"]))
  (define tamanyoVector (new text-field% [parent menu] [style (list 'single 'vertical-label)]
                             [label "Numero de elementos"] [init-value (number->string 1)]))

  (define (clickenbotonOK button event)
    (define nuevoTamanyoVector (string->number (send tamanyoVector get-value)))
    
    (define (aux nuevoTamanyoVector)
      (do
          (
           (i 0 (+ i 1))
           (vector2 (vector) (vector-append vector2 (vector (inexact->exact (round (* 10 (random)))))))
           )
        ( (= i nuevoTamanyoVector) vector2)
        )
      )
    (define v (aux nuevoTamanyoVector))
    (QuickSort v)
    (send menu show #f)
    (programa)
    )
  
                  
      
  (define botonOK (new button% [parent menu] [label "OK"] [callback clickenbotonOK]))
  (send menu show #t)
  
  )


(define (cargarFicheroQS button event)
  (mensaje "Introduzca el nombre del fichero (use comillas)")
  (define fichero (read))
  (if (not (file-exists? fichero))
      (mensaje "Fallo en la carga del vector")
      )      
  (define puerto (open-input-file fichero))
  (define vector (read puerto))
  (if (vector? vector)
      (QuickSort vector)
      (mensaje "Fallo en la carga del vector")
      )
  (programa)
  )



(define (AuxQuickSortAscendente button event)
  (define (volverMenu button event)
    (close-graphics)
    (send menu2 show #f)
    (programa)
    )
  (define menu2 (new frame% [label "Quick Sort ascendente"]))
  (define boton1 (new button% [parent menu2] [label "Rellenar vector"] [callback rellenarVectorQS]))
  (define boton2 (new button% [parent menu2] [label "Rellenar vector con valores aleatorios"] [callback rellenarVectorAleatoriosQS]))
  (define boton3 (new button% [parent menu2] [label "Cargar desde fichero"] [callback cargarFicheroQS]))
  (define boton4 (new button% [parent menu2] [label "Volver al menu"] [callback volverMenu]))
  (send menu2 show #t)
  )

;;SELECCION
(define (rellenarVectorS button event)
  
  (define menu (new frame% [label "Rellenar vector"]))
  (define tamanyoVector (new text-field% [parent menu] [style (list 'single 'vertical-label)]
                             [label "Numero de elementos"] [init-value (number->string 1)]))

  (define (clickenbotonOK button event) 
    (define nuevoTamanyoVector (string->number (send tamanyoVector get-value)))
    (define aux 0)

    (define (auxRellenarS nuevoTamanyoVector)
      (do
          (
           (i 0 (+ i 1))
           (vector2 (vector) (vector-append vector2 (vector aux)) )
           )
        
        ( (= i nuevoTamanyoVector) vector2  )
        (mensaje "Introduzca la componente del vector")
        (set! aux (read))
        )
      )

    (define v (auxRellenarS nuevoTamanyoVector))
    (mensaje "El vector a ordenar por Seleccion es:")
    (mostrarVector v)
    (seleccionSort v)
      
    (send menu show #f)
    (programa)
    )
  
  (define botonOK (new button% [parent menu] [label "OK"][callback clickenbotonOK] ))
  (send menu show #t)
 
  )

(define (rellenarVectorAleatoriosS button event)
  
  (define menu (new frame% [label "Rellenar vector"]))
  (define tamanyoVector (new text-field% [parent menu] [style (list 'single 'vertical-label)]
                             [label "Numero de elementos"] [init-value (number->string 1)]))

  (define (clickenbotonOK button event)
    (define nuevoTamanyoVector (string->number (send tamanyoVector get-value)))
    
    (define (aux nuevoTamanyoVector)
      (do
          (
           (i 0 (+ i 1))
           (vector2 (vector) (vector-append vector2 (vector (inexact->exact (round (* 10 (random)))))))
           )
        ( (= i nuevoTamanyoVector) vector2)
        )
      )
    (define v (aux nuevoTamanyoVector))
    (seleccionSort v)
    (send menu show #f)
    (programa)
    )
  
                  
      
  (define botonOK (new button% [parent menu] [label "OK"] [callback clickenbotonOK]))
  (send menu show #t)
  
  )

(define (cargarFicheroS button event)
  (mensaje "Introduzca el nombre del fichero (use comillas)")
  (define fichero (read))
  (if (not (file-exists? fichero))
      (mensaje "Fallo en la carga del vector")
      )      
  (define puerto (open-input-file fichero))
  (define vector (read puerto))
  (if (vector? vector)
      (seleccionSort vector)
      (mensaje "Fallo en la carga del vector")
      )
  (programa)
  )

(define (AuxSeleccionAscendente button event)
  (define (volverMenu button event)
    (close-graphics)
    (send menu2 show #f)
    (programa)
    )
  (define menu2 (new frame% [label "Seleccion ascendente"]))
  (define boton1 (new button% [parent menu2] [label "Rellenar vector"] [callback rellenarVectorS]))
  (define boton2 (new button% [parent menu2] [label "Rellenar vector con valores aleatorios"] [callback rellenarVectorAleatoriosS]))
  (define boton3 (new button% [parent menu2] [label "Cargar desde fichero"] [callback cargarFicheroS]))
  (define boton4 (new button% [parent menu2] [label "Volver al menu"] [callback volverMenu]))
  (send menu2 show #t)
  )


;;INSERCCION
(define (rellenarVectorI button event)
  
  (define menu (new frame% [label "Rellenar vector"]))
  (define tamanyoVector (new text-field% [parent menu] [style (list 'single 'vertical-label)]
                             [label "Numero de elementos"] [init-value (number->string 1)]))

  (define (clickenbotonOK button event) 
    (define nuevoTamanyoVector (string->number (send tamanyoVector get-value)))
    (define aux 0)

    (define (auxRellenarI nuevoTamanyoVector)
      (do
          (
           (i 0 (+ i 1))
           (vector2 (vector) (vector-append vector2 (vector aux)) )
           )
        
        ( (= i nuevoTamanyoVector) vector2  )
        (mensaje "Introduzca la componente del vector")
        (set! aux (read))
        )
      )

    (define v (auxRellenarI nuevoTamanyoVector))
    (insertionSort v)
      
    (send menu show #f)
    (programa)
    )
  
  (define botonOK (new button% [parent menu] [label "OK"][callback clickenbotonOK] ))
  (send menu show #t)
 
  )


(define (rellenarVectorAleatoriosI button event)
  
  (define menu (new frame% [label "Rellenar vector"]))
  (define tamanyoVector (new text-field% [parent menu] [style (list 'single 'vertical-label)]
                             [label "Numero de elementos"] [init-value (number->string 1)]))

  (define (clickenbotonOK button event)
    (define nuevoTamanyoVector (string->number (send tamanyoVector get-value)))
    
    (define (aux nuevoTamanyoVector)
      (do
          (
           (i 0 (+ i 1))
           (vector2 (vector) (vector-append vector2 (vector (inexact->exact (round (* 10 (random)))))))
           )
        ( (= i nuevoTamanyoVector) vector2)
        )
      )
    (define v (aux nuevoTamanyoVector))
    (insertionSort v)
    (send menu show #f)
    (programa)
    )
  
                  
      
  (define botonOK (new button% [parent menu] [label "OK"] [callback clickenbotonOK]))
  (send menu show #t)
  
  )

(define (cargarFicheroI button event)
  (mensaje "Introduzca el nombre del fichero (use comillas)")
  (define fichero (read))
  (if (not (file-exists? fichero))
      (mensaje "Fallo en la carga del vector")
      )      
  (define puerto (open-input-file fichero))
  (define vector (read puerto))
  (if (vector? vector)
      (insertionSort vector)
      (mensaje "Fallo en la carga del vector")
      )
  (programa)
  )



(define (AuxInserccionAscendente button event)
  (define (volverMenu button event)
    (close-graphics)
    (send menu2 show #f)
    (programa)
    )
  (define menu2 (new frame% [label "Inserccion ascendente"]))
  (define boton1 (new button% [parent menu2] [label "Rellenar vector"] [callback rellenarVectorI]))
  (define boton2 (new button% [parent menu2] [label "Rellenar vector con valores aleatorios"] [callback rellenarVectorAleatoriosI]))
  (define boton3 (new button% [parent menu2] [label "Cargar desde fichero"] [callback cargarFicheroI]))
  (define boton4 (new button% [parent menu2] [label "Volver al menu"] [callback volverMenu]))
  (send menu2 show #t)
  )

;;COMPETICION DE ALGORITMOS
(define (AuxCompeticion button event)
  
  (define menu (new frame% [label "Rellenar vector"]))
  (define tamanyoVector (new text-field% [parent menu] [style (list 'single 'vertical-label)]
                             [label "Numero de elementos (se recomienda introducir muchos)"] [init-value (number->string 1)]))

  (define (clickenbotonOK button event)
    (define nuevoTamanyoVector (string->number (send tamanyoVector get-value)))
    
    (define (aux nuevoTamanyoVector)
      (do
          (
           (i 0 (+ i 1))
           (vector2 (vector) (vector-append vector2 (vector (* 10 (random)))))
           )
        ( (= i nuevoTamanyoVector) vector2)
        )
      )
    
    (define v (aux nuevoTamanyoVector))
    (competicion v)
    (send menu show #f)
    (programa)
    )
  
                  
      
  (define botonOK (new button% [parent menu] [label "OK"] [callback clickenbotonOK]))
  (send menu show #t)
  
  )


;; BURBUJA DESCENDENTE

(define (rellenarVectorBurbujaDescendente button event)
  
  (define menu (new frame% [label "Rellenar vector"]))
  (define tamanyoVector (new text-field% [parent menu] [style (list 'single 'vertical-label)]
                             [label "Numero de elementos"] [init-value (number->string 1)]))

  (define (clickenbotonOK button event) 
    (define nuevoTamanyoVector (string->number (send tamanyoVector get-value)))
    (define aux 0)

    (define (auxRellenarBurbujaDescendente nuevoTamanyoVector)
      (do
          (
           (i 0 (+ i 1))
           (vector2 (vector) (vector-append vector2 (vector aux)) )
           )
        
        ( (= i nuevoTamanyoVector) vector2  )
        (mensaje "Introduzca la componente del vector")
        (set! aux (read))
        )
      )

    (define v (auxRellenarBurbujaDescendente nuevoTamanyoVector))
    (burbujaInverso v)
      
    (send menu show #f)
    (programa)
    )
  
  (define botonOK (new button% [parent menu] [label "OK"][callback clickenbotonOK] ))
  (send menu show #t)
 
  )


(define (rellenarVectorAleatoriosBurbujaDescendente button event)
  
  (define menu (new frame% [label "Rellenar vector"]))
  (define tamanyoVector (new text-field% [parent menu] [style (list 'single 'vertical-label)]
                             [label "Numero de elementos"] [init-value (number->string 1)]))

  (define (clickenbotonOK button event)
    (define nuevoTamanyoVector (string->number (send tamanyoVector get-value)))
    
    (define (aux nuevoTamanyoVector)
      (do
          (
           (i 0 (+ i 1))
           (vector2 (vector) (vector-append vector2 (vector (inexact->exact (round (* 10 (random)))))))
           )
        ( (= i nuevoTamanyoVector) vector2)
        )
      )
    (define v (aux nuevoTamanyoVector))
    (burbujaInverso v)
    (send menu show #f)
    (programa)
    )
  
                  
      
  (define botonOK (new button% [parent menu] [label "OK"] [callback clickenbotonOK]))
  (send menu show #t)
  
  )

(define (cargarFicheroBurbujaDescendente button event)
  (mensaje "Introduzca el nombre del fichero (use comillas)")
  (define fichero (read))
  (if (not (file-exists? fichero))
      (mensaje "Fallo en la carga del vector")
      )      
  (define puerto (open-input-file fichero))
  (define vector (read puerto))
  (if (vector? vector)
      (burbujaInverso vector)
      (mensaje "Fallo en la carga del vector")
      )
  (programa)
  )




(define (AuxBurbujaDescendente button event)
  (define (volverMenu button event)
    (close-graphics)
    (send menu2 show #f)
    (programa)
    )
  (define menu2 (new frame% [label "Burbuja descendente"]))
  (define boton1 (new button% [parent menu2] [label "Rellenar vector"] [callback rellenarVectorBurbujaDescendente]))
  (define boton2 (new button% [parent menu2] [label "Rellenar vector con valores aleatorios"] [callback rellenarVectorAleatoriosBurbujaDescendente]))
  (define boton3 (new button% [parent menu2] [label "Cargar desde fichero"] [callback cargarFicheroBurbujaDescendente]))
  (define boton4 (new button% [parent menu2] [label "Volver al menu"] [callback volverMenu]))
  (send menu2 show #t)
  )

;;MERGE SORT DESCENDIENTE
;
(define (rellenarVectorAleatoriosMGDescendente button event)
  
  (define menu (new frame% [label "Rellenar vector"]))
  (define tamanyoVector (new text-field% [parent menu] [style (list 'single 'vertical-label)]
                             [label "Numero de elementos"] [init-value (number->string 1)]))

  (define (clickenbotonOK button event)
    (define nuevoTamanyoVector (string->number (send tamanyoVector get-value)))
    
    (define (aux nuevoTamanyoVector)
      (do
          (
           (i 0 (+ i 1))
           (vector2 (vector) (vector-append vector2 (vector (inexact->exact (round (* 10 (random)))))))
           )
        ( (= i nuevoTamanyoVector) vector2)
        )
      )
    (define v (aux nuevoTamanyoVector))
    (mensaje "El vector a ordenar por Merge Sort es:")
    (mostrarVector v)
    (mergeSortInverso (vector->list v))
    (send menu show #f)
    (programa)
    )
  
                  
      
  (define botonOK (new button% [parent menu] [label "OK"] [callback clickenbotonOK]))
  (send menu show #t)
  
  )


(define (cargarFicheroMGDescendente button event)
  (mensaje "Introduzca el nombre del fichero (use comillas)")
  (define fichero (read))
  (if (not (file-exists? fichero))
      (mensaje "Fallo en la carga del vector")
      )      
  (define puerto (open-input-file fichero))
  (define vector (read puerto))
  (if (vector? vector)
      (mergeSortInverso (vector->list vector))
      (mensaje "Fallo en la carga del vector")
      )
  (programa)
  )



(define (rellenarVectorMGDescendente button event)
  
  (define menu (new frame% [label "Rellenar vector"]))
  (define tamanyoVector (new text-field% [parent menu] [style (list 'single 'vertical-label)]
                             [label "Numero de elementos"] [init-value (number->string 1)]))

  (define (clickenbotonOK button event) 
    (define nuevoTamanyoVector (string->number (send tamanyoVector get-value)))
    (define aux 0)

    (define (auxRellenarMG nuevoTamanyoVector)
      (do
          (
           (i 0 (+ i 1))
           (vector2 (vector) (vector-append vector2 (vector aux)) )
           )
        
        ( (= i nuevoTamanyoVector) vector2  )
        (mensaje "Introduzca la componente del vector")
        (set! aux (read))
        )
      )

    (define v (auxRellenarMG nuevoTamanyoVector))
    (mensaje "El vector a ordenar por Merge Sort es:")
    (mostrarVector v)
    (mergeSortInverso (vector->list v))
      
    (send menu show #f)
    (programa)
    )
  
  (define botonOK (new button% [parent menu] [label "OK"][callback clickenbotonOK] ))
  (send menu show #t)
 
  )


(define (AuxMergeSortDescendente button event)
  (define (volverMenu button event)
    (close-graphics)
    (send menu2 show #f)
    (programa)
    )
  (define menu2 (new frame% [label "Merge Sort descendente"]))
  (define boton1 (new button% [parent menu2] [label "Rellenar vector"] [callback rellenarVectorMGDescendente]))
  (define boton2 (new button% [parent menu2] [label "Rellenar vector con valores aleatorios"] [callback rellenarVectorAleatoriosMGDescendente]))
  (define boton3 (new button% [parent menu2] [label "Cargar desde fichero"] [callback cargarFicheroMGDescendente]))
  (define boton4 (new button% [parent menu2] [label "Volver al menu"] [callback volverMenu]))
  (send menu2 show #t)
  )



;;QUICK SORT DESCENDENTE
(define (rellenarVectorQSDescendente button event)
  
  (define menu (new frame% [label "Rellenar vector"]))
  (define tamanyoVector (new text-field% [parent menu] [style (list 'single 'vertical-label)]
                             [label "Numero de elementos"] [init-value (number->string 1)]))

  (define (clickenbotonOK button event) 
    (define nuevoTamanyoVector (string->number (send tamanyoVector get-value)))
    (define aux 0)

    (define (auxRellenarQS nuevoTamanyoVector)
      (do
          (
           (i 0 (+ i 1))
           (vector2 (vector) (vector-append vector2 (vector aux)) )
           )
        
        ( (= i nuevoTamanyoVector) vector2  )
        (mensaje "Introduzca la componente del vector")
        (set! aux (read))
        )
      )

    (define v (auxRellenarQS nuevoTamanyoVector))
    (mensaje "El vector a ordenar por Quick Sort es:")
    (mostrarVector v)
    (QuickSortInverso v)
      
    (send menu show #f)
    (programa)
    )
  
  (define botonOK (new button% [parent menu] [label "OK"][callback clickenbotonOK] ))
  (send menu show #t)
 
  )


(define (rellenarVectorAleatoriosQSDescendente button event)
  
  (define menu (new frame% [label "Rellenar vector"]))
  (define tamanyoVector (new text-field% [parent menu] [style (list 'single 'vertical-label)]
                             [label "Numero de elementos"] [init-value (number->string 1)]))

  (define (clickenbotonOK button event)
    (define nuevoTamanyoVector (string->number (send tamanyoVector get-value)))
    
    (define (aux nuevoTamanyoVector)
      (do
          (
           (i 0 (+ i 1))
           (vector2 (vector) (vector-append vector2 (vector (inexact->exact (round (* 10 (random)))))))
           )
        ( (= i nuevoTamanyoVector) vector2)
        )
      )
    (define v (aux nuevoTamanyoVector))
    (QuickSortInverso v)
    (send menu show #f)
    (programa)
    )
  
                  
      
  (define botonOK (new button% [parent menu] [label "OK"] [callback clickenbotonOK]))
  (send menu show #t)
  
  )


(define (cargarFicheroQSDescendente button event)
  (mensaje "Introduzca el nombre del fichero (use comillas)")
  (define fichero (read))
  (if (not (file-exists? fichero))
      (mensaje "Fallo en la carga del vector")
      )      
  (define puerto (open-input-file fichero))
  (define vector (read puerto))
  (if (vector? vector)
      (QuickSortInverso vector)
      (mensaje "Fallo en la carga del vector")
      )
  (programa)
  )



(define (AuxQuickSortDescendente button event)
  (define (volverMenu button event)
    (close-graphics)
    (send menu2 show #f)
    (programa)
    )
  (define menu2 (new frame% [label "Quick Sort descendente"]))
  (define boton1 (new button% [parent menu2] [label "Rellenar vector"] [callback rellenarVectorQSDescendente]))
  (define boton2 (new button% [parent menu2] [label "Rellenar vector con valores aleatorios"] [callback rellenarVectorAleatoriosQSDescendente]))
  (define boton3 (new button% [parent menu2] [label "Cargar desde fichero"] [callback cargarFicheroQSDescendente]))
  (define boton4 (new button% [parent menu2] [label "Volver al menu"] [callback volverMenu]))
  (send menu2 show #t)
  )


;;SELECCION DESCENDENTE
(define (rellenarVectorSDescendente button event)
  
  (define menu (new frame% [label "Rellenar vector"]))
  (define tamanyoVector (new text-field% [parent menu] [style (list 'single 'vertical-label)]
                             [label "Numero de elementos"] [init-value (number->string 1)]))

  (define (clickenbotonOK button event) 
    (define nuevoTamanyoVector (string->number (send tamanyoVector get-value)))
    (define aux 0)

    (define (auxRellenarS nuevoTamanyoVector)
      (do
          (
           (i 0 (+ i 1))
           (vector2 (vector) (vector-append vector2 (vector aux)) )
           )
        
        ( (= i nuevoTamanyoVector) vector2  )
        (mensaje "Introduzca la componente del vector")
        (set! aux (read))
        )
      )

    (define v (auxRellenarS nuevoTamanyoVector))
    (mensaje "El vector a ordenar por Seleccion es:")
    (mostrarVector v)
    (seleccionSortInverso v)
      
    (send menu show #f)
    (programa)
    )
  
  (define botonOK (new button% [parent menu] [label "OK"][callback clickenbotonOK] ))
  (send menu show #t)
 
  )

(define (rellenarVectorAleatoriosSDescendente button event)
  
  (define menu (new frame% [label "Rellenar vector"]))
  (define tamanyoVector (new text-field% [parent menu] [style (list 'single 'vertical-label)]
                             [label "Numero de elementos"] [init-value (number->string 1)]))

  (define (clickenbotonOK button event)
    (define nuevoTamanyoVector (string->number (send tamanyoVector get-value)))
    
    (define (aux nuevoTamanyoVector)
      (do
          (
           (i 0 (+ i 1))
           (vector2 (vector) (vector-append vector2 (vector (inexact->exact (round (* 10 (random)))))))
           )
        ( (= i nuevoTamanyoVector) vector2)
        )
      )
    (define v (aux nuevoTamanyoVector))
    (seleccionSortInverso v)
    (send menu show #f)
    (programa)
    )
  
                  
      
  (define botonOK (new button% [parent menu] [label "OK"] [callback clickenbotonOK]))
  (send menu show #t)
  
  )

(define (cargarFicheroSDescendente button event)
  (mensaje "Introduzca el nombre del fichero (use comillas)")
  (define fichero (read))
  (if (not (file-exists? fichero))
      (mensaje "Fallo en la carga del vector")
      )      
  (define puerto (open-input-file fichero))
  (define vector (read puerto))
  (if (vector? vector)
      (seleccionSortInverso vector)
      (mensaje "Fallo en la carga del vector")
      )
  (programa)
  )

(define (AuxSeleccionDescendente button event)
  (define (volverMenu button event)
    (close-graphics)
    (send menu2 show #f)
    (programa)
    )
  (define menu2 (new frame% [label "Seleccion descendiente"]))
  (define boton1 (new button% [parent menu2] [label "Rellenar vector"] [callback rellenarVectorSDescendente]))
  (define boton2 (new button% [parent menu2] [label "Rellenar vector con valores aleatorios"] [callback rellenarVectorAleatoriosSDescendente]))
  (define boton3 (new button% [parent menu2] [label "Cargar desde fichero"] [callback cargarFicheroSDescendente]))
  (define boton4 (new button% [parent menu2] [label "Volver al menu"] [callback volverMenu]))
  (send menu2 show #t)
  )


;;INSERCCION DESCENDENTE
(define (rellenarVectorIDescendente button event)
  
  (define menu (new frame% [label "Rellenar vector"]))
  (define tamanyoVector (new text-field% [parent menu] [style (list 'single 'vertical-label)]
                             [label "Numero de elementos"] [init-value (number->string 1)]))

  (define (clickenbotonOK button event) 
    (define nuevoTamanyoVector (string->number (send tamanyoVector get-value)))
    (define aux 0)

    (define (auxRellenarI nuevoTamanyoVector)
      (do
          (
           (i 0 (+ i 1))
           (vector2 (vector) (vector-append vector2 (vector aux)) )
           )
        
        ( (= i nuevoTamanyoVector) vector2  )
        (mensaje "Introduzca la componente del vector")
        (set! aux (read))
        )
      )

    (define v (auxRellenarI nuevoTamanyoVector))
    (insertionSortInverso v)
      
    (send menu show #f)
    (programa)
    )
  
  (define botonOK (new button% [parent menu] [label "OK"][callback clickenbotonOK] ))
  (send menu show #t)
 
  )


(define (rellenarVectorAleatoriosIDescendente button event)
  
  (define menu (new frame% [label "Rellenar vector"]))
  (define tamanyoVector (new text-field% [parent menu] [style (list 'single 'vertical-label)]
                             [label "Numero de elementos"] [init-value (number->string 1)]))

  (define (clickenbotonOK button event)
    (define nuevoTamanyoVector (string->number (send tamanyoVector get-value)))
    
    (define (aux nuevoTamanyoVector)
      (do
          (
           (i 0 (+ i 1))
           (vector2 (vector) (vector-append vector2 (vector (inexact->exact (round (* 10 (random)))))))
           )
        ( (= i nuevoTamanyoVector) vector2)
        )
      )
    (define v (aux nuevoTamanyoVector))
    (insertionSortInverso v)
    (send menu show #f)
    (programa)
    )
  
                  
      
  (define botonOK (new button% [parent menu] [label "OK"] [callback clickenbotonOK]))
  (send menu show #t)
  
  )

(define (cargarFicheroIDescendente button event)
  (mensaje "Introduzca el nombre del fichero (use comillas)")
  (define fichero (read))
  (if (not (file-exists? fichero))
      (mensaje "Fallo en la carga del vector")
      )      
  (define puerto (open-input-file fichero))
  (define vector (read puerto))
  (if (vector? vector)
      (insertionSortInverso vector)
      (mensaje "Fallo en la carga del vector")
      )
  (programa)
  )


(define (AuxInserccionDescendente button event)
  (define (volverMenu button event)
    (close-graphics)
    (send menu2 show #f)
    (programa)
    )
  
  (define menu2 (new frame% [label "Inserccion descendente"]))
  (define boton1 (new button% [parent menu2] [label "Rellenar vector"] [callback rellenarVectorIDescendente]))
  (define boton2 (new button% [parent menu2] [label "Rellenar vector con valores aleatorios"] [callback rellenarVectorAleatoriosIDescendente]))
  (define boton3 (new button% [parent menu2] [label "Cargar desde fichero"] [callback cargarFicheroIDescendente]))
  (define boton4 (new button% [parent menu2] [label "Volver al menu"] [callback volverMenu]))
  (send menu2 show #t)
  )



;;MENU PRINCIPAL
(define (programa)
  (define (clickenSalir button event)
    ;; Cerrar ventanas de gráficos
    (close-graphics)
    ;; Ocultar ventana de menú
    (send menu show #f)
    )

  
  (define menu (new frame% [label "Menu principal"]))
  (define boton1 (new button% [parent menu] [label "Burbuja ascendente"] [callback AuxBurbujaAscendente]))
  (define boton2 (new button% [parent menu] [label "Merge Sort ascendente"] [callback AuxMergeSortAscendente]))
  (define boton3 (new button% [parent menu] [label "Quick Sort ascendente"] [callback AuxQuickSortAscendente]))
  (define boton4 (new button% [parent menu] [label "Seleccion ascendente"] [callback AuxSeleccionAscendente]))
  (define boton5 (new button% [parent menu] [label "Inserccion ascendente"] [callback AuxInserccionAscendente]))
  (define boton6 (new button% [parent menu] [label "Competicion de algoritmos"] [callback AuxCompeticion]))
  
  (define boton7 (new button% [parent menu] [label "Burbuja descendente"] [callback AuxBurbujaDescendente]))
  (define boton8 (new button% [parent menu] [label "Merge Sort descendente"] [callback AuxMergeSortDescendente]))
  (define boton9 (new button% [parent menu] [label "Quick Sort descendente"] [callback AuxQuickSortDescendente]))
  (define boton10 (new button% [parent menu] [label "Seleccion descendente"] [callback AuxSeleccionDescendente]))
  (define boton11 (new button% [parent menu] [label "Inserccion descendente"] [callback AuxInserccionDescendente]))
  (define boton12 (new button% [parent menu] [label "Salir"] [callback clickenSalir]))
  
  (send menu show #t)


  )

(programa)